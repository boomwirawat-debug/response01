<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>เกมจับคู่ขบวนรถไฟ</title>
    <!-- เพิ่มฟอนต์ภาษาไทยจาก Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- CSS Styles --- */
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #f0f2f5; /* สีพื้นหลังอ่อน */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 15px; /* เพิ่ม padding สำหรับหน้าจอมือถือ */
            box-sizing: border-box; /* ช่วยในการคำนวณขนาด */
        }

        #game-container {
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.1);
            padding: 25px;
            width: 100%; /* ปรับให้เต็มความกว้างของ-padding */
            max-width: 600px;
            text-align: center;
            box-sizing: border-box;
        }

        h1 {
            color: #1a3a66;
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        #score-counter {
            font-size: 1rem;
            color: #555;
            margin-bottom: 20px;
            font-weight: 600;
            min-height: 20px; /* จองพื้นที่ */
        }

        #question-container {
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            min-height: 50px; /* ความสูงขั้นต่ำ */
        }

        #question {
            font-size: 1.3rem; /* ขนาดตัวอักษรสำหรับคำถาม */
            font-weight: bold;
            color: #0056b3;
            line-height: 1.4;
        }

        #options-container {
            display: flex;
            flex-direction: column;
            gap: 12px; /* ระยะห่างระหว่างปุ่ม */
        }

        .option-button {
            font-family: 'Sarabun', sans-serif;
            background-color: #007bff;
            color: white;
            border: 2px solid transparent; /* เพิ่มขอบใสไว้ */
            border-radius: 8px;
            padding: 12px 15px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease, border-color 0.3s ease;
            width: 100%;
            box-sizing: border-box; /* คำนวณ padding ให้ถูกต้อง */
        }

        /* เอฟเฟกต์เมื่อวางเมาส์บนปุ่ม (สำหรับเดสก์ท็อป) */
        .option-button:hover:not(:disabled) {
            background-color: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        /* สถานะ: ถูกเลือก */
        .option-button.selected {
            background-color: #ffc107; /* สีเหลือง */
            color: #212529;
            border-color: #e0a800; /* ขอบสีเหลืองเข้ม */
        }

        .option-button:disabled {
            cursor: not-allowed;
            opacity: 0.8; /* ปรับให้จางลงเล็กน้อยเมื่อปิดใช้งาน */
        }

        /* สถานะ: ถูกต้อง */
        .option-button.correct {
            background-color: #28a745;
            color: white;
            opacity: 1;
            border-color: #28a745;
        }

        /* สถานะ: ผิด */
        .option-button.incorrect {
            background-color: #dc3545;
            color: white;
            opacity: 1;
            border-color: #dc3545;
        }

        #feedback {
            font-size: 1.15rem;
            font-weight: bold;
            margin-top: 15px;
            height: 30px; /* จองพื้นที่สำหรับข้อความ */
            line-height: 30px;
        }

        /* (ใหม่) คอนเทนเนอร์สำหรับปุ่ม Submit และ Skip/Next */
        #action-button-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }
        
        /* (ใหม่) ปุ่มพื้นฐานสำหรับ action buttons */
        .action-btn {
            font-family: 'Sarabun', sans-serif;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 25px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        /* (ใหม่) ปุ่มส่งคำตอบ */
        #submit-button {
            background-color: #007bff; /* สีน้ำเงิน */
        }
        #submit-button:hover {
            background-color: #0056b3;
        }

        /* (แก้ไข) ปุ่มข้าม / ข้อถัดไป */
        #navigation-button {
            background-color: #6c757d; /* สีเทา */
        }
        #navigation-button:hover {
            background-color: #5a6268;
        }


        /* --- Responsive Design --- */
        @media (max-width: 480px) {
            h1 {
                font-size: 1.6rem;
            }
            #question {
                font-size: 1.15rem;
            }
            .option-button, .action-btn {
                font-size: 1rem;
                padding: 10px 12px;
            }
            #game-container {
                padding: 20px;
            }
            #action-button-container {
                flex-direction: column; /* เรียงปุ่มแนวตั้งบนจอมือถือ */
            }
        }
    </style>
</head>
<body>

    <!-- --- HTML Structure --- -->
    <div id="game-container">
        <h1>เกมจับคู่ขบวนรถไฟ</h1>
        <div id="score-counter">กำลังโหลด...</div>
        <div id="question-container">
            <div id="question">กำลังโหลดคำถาม...</div>
        </div>
        <div id="options-container">
            <!-- ตัวเลือกจะถูกสร้างโดย JavaScript -->
        </div>
        <div id="feedback"></div>

        <!-- (ใหม่) Action Buttons Container -->
        <div id="action-button-container">
            <button id="submit-button" class="action-btn" style="display: none;">ส่งคำตอบ</button>
            <button id="navigation-button" class="action-btn">ข้าม</button> <!-- (แก้ไข) เปลี่ยนจาก next-button -->
        </div>
    </div>

    <!-- --- JavaScript Logic --- -->
    <script>
        // --- ข้อมูลรถไฟทั้งหมด 177 ขบวน (จากไฟล์ PDF) ---
        const trainData = [
            // ... (ข้อมูล 177 ขบวน อยู่ที่นี่) ...
            { question: "กรุงเทพอภิวัฒน์ - ชุมทางหาดใหญ่", answer: "31 CNR" },
            { question: "ชุมทางหาดใหญ่ - กรุงเทพอภิวัฒน์", answer: "32 CNR" },
            { question: "กรุงเทพอภิวัฒน์ - สุไหงโก-ลก", answer: "37" },
            { question: "สุไหงโก-ลก - กรุงเทพอภิวัฒน์", answer: "38" },
            { question: "กรุงเทพอภิวัฒน์ - สุราษฎร์ธานี", answer: "39" },
            { question: "สุราษฎร์ธานี - กรุงเทพอภิวัฒน์", answer: "40" },
            { question: "กรุงเทพอภิวัฒน์ - สุราษฎร์ธานี", answer: "43" },
            { question: "สุราษฎร์ธานี - กรุงเทพอภิวัฒน์", answer: "44" },
            { question: "กรุงเทพอภิวัฒน์ - ปาดังเบซาร์", answer: "45" },
            { question: "ปาดังเบซาร์ - กรุงเทพอภิวัฒน์", answer: "46" },
            { question: "กรุงเทพอภิวัฒน์ - ตรัง", answer: "83" },
            { question: "ตรัง - กรุงเทพอภิวัฒน์", answer: "84" },
            { question: "กรุงเทพอภิวัฒน์ - นครศรีธรรมราช", answer: "85" },
            { question: "นครศรีธรรมราช - กรุงเทพอภิวัฒน์", answer: "86" },
            { question: "กรุงเทพอภิวัฒน์ - กันตัง", answer: "167" },
            { question: "กันตัง - กรุงเทพอภิวัฒน์", answer: "168" },
            { question: "กรุงเทพอภิวัฒน์ - ยะลา", answer: "169" },
            { question: "ยะลา - กรุงเทพอภิวัฒน์", answer: "170" },
            { question: "กรุงเทพอภิวัฒน์ - สุไหงโก-ลก", answer: "171" },
            { question: "สุไหงโก-ลก - กรุงเทพอภิวัฒน์", answer: "172" },
            { question: "ธนบุรี - ประจวบคีรีขันธ์", answer: "251" },
            { question: "ประจวบคีรีขันธ์ - ธนบุรี", answer: "252" },
            { question: "ธนบุรี - หลังสวน", answer: "255" },
            { question: "หลังสวน - ธนบุรี", answer: "254" },
            { question: "ธนบุรี - น้ำตก", answer: "257" },
            { question: "น้ำตก - ธนบุรี", answer: "258" },
            { question: "ธนบุรี - น้ำตก", answer: "259" },
            { question: "น้ำตก - ธนบุรี", answer: "260" },
            { question: "กรุงเทพ (หัวลำโพง) - สวนสนประดิพัทธ์", answer: "261" },
            { question: "สวนสนประดิพัทธ์ - กรุงเทพ (หัวลำโพง)", answer: "262" },
            { question: "ธนบุรี - ราชบุรี", answer: "351" },
            { question: "ราชบุรี - ธนบุรี", answer: "352" },
            { question: "กรุงเทพ (หัวลำโพง) - บ้านโป่ง", answer: "355" },
            { question: "บ้านโป่ง - กรุงเทพ (หัวลำโพง)", answer: "356" },
            { question: "ชุมพร - ชุมทางหาดใหญ่", answer: "445" },
            { question: "ชุมทางหาดใหญ่ - ชุมพร", answer: "446" },
            { question: "สุราษฎร์ธานี - สุไหงโก-ลก", answer: "447" },
            { question: "สุไหงโก-ลก - สุราษฎร์ธานี", answer: "448" },
            { question: "นครศรีธรรมราช - สุไหงโก-ลก", answer: "451" },
            { question: "สุไหงโก-ลก - นครศรีธรรมราช", answer: "452" },
            { question: "ยะลา - สุไหงโก-ลก", answer: "453" },
            { question: "สุไหงโก-ลก - ยะลา", answer: "454" },
            { question: "นครศรีธรรมราช - ยะลา", answer: "455" },
            { question: "ยะลา - นครศรีธรรมราช", answer: "456" },
            { question: "พัทลุง - สุไหงโก-ลก", answer: "463" },
            { question: "สุไหงโก-ลก - พัทลุง", answer: "464" },
            { question: "กาญจนบุรี - น้ำตก", answer: "485" },
            { question: "น้ำตก - กาญจนบุรี", answer: "486" },
            { question: "สุราษฎร์ธานี - คีรีรัฐนิคม", answer: "489" },
            { question: "คีรีรัฐนิคม - สุราษฎร์ธานี", answer: "490" },
            { question: "ชุมทางหาดใหญ่ - ปาดังเบซาร์", answer: "947" },
            { question: "ปาดังเบซาร์ - ชุมทางหาดใหญ่", answer: "948" },
            { question: "ชุมทางหาดใหญ่ - ปาดังเบซาร์", answer: "949" },
            { question: "ปาดังเบซาร์ - ชุมทางหาดใหญ่", answer: "950" },
            { question: "ธนบุรี - นครปฐม", answer: "1115" },
            { question: "นครปฐม - ธนบุรี", answer: "1116" },
            { question: "ธนบุรี - นครปฐม", answer: "1117" },
            { question: "นครปฐม - ธนบุรี", answer: "1118" },
            { question: "ธนบุรี - นครปฐม", answer: "1123" },
            { question: "นครปฐม - ธนบุรี", answer: "1124" },
            { question: "ธนบุรี - นครปฐม", answer: "1129" },
            { question: "นครปฐม - ธนบุรี", answer: "1132" },
            { question: "กรุงเทพอภิวัฒน์ - เชียงใหม่", answer: "7" },
            { question: "เชียงใหม่ - กรุงเทพอภิวัฒน์", answer: "8" },
            { question: "กรุงเทพอภิวัฒน์ - เชียงใหม่", answer: "9 CNR" },
            { question: "เชียงใหม่ - กรุงเทพอภิวัฒน์", answer: "10 CNR" },
            { question: "กรุงเทพอภิวัฒน์ - เชียงใหม่", answer: "13" },
            { question: "เชียงใหม่ - กรุงเทพอภิวัฒน์", answer: "14" },
            { question: "กรุงเทพอภิวัฒน์ - เชียงใหม่", answer: "51" },
            { question: "เชียงใหม่ - กรุงเทพอภิวัฒน์", answer: "52" },
            { question: "เชียงใหม่ - กรุงเทพอภิวัฒน์", answer: "102" },
            { question: "กรุงเทพอภิวัฒน์ - เด่นชัย", answer: "107" },
            { question: "เด่นชัย - กรุงเทพอภิวัฒน์", answer: "108" },
            { question: "กรุงเทพอภิวัฒน์ - เชียงใหม่", answer: "109" },
            { question: "กรุงเทพอภิวัฒน์ - เด่นชัย", answer: "111" },
            { question: "เด่นชัย - กรุงเทพอภิวัฒน์", answer: "112" },
            { question: "กรุงเทพ (หัวลำโพง) - พิษณุโลก", answer: "201" },
            { question: "พิษณุโลก - กรุงเทพ (หัวลำโพง)", answer: "202" },
            { question: "กรุงเทพ (หัวลำโพง) - นครสวรรค์", answer: "207" },
            { question: "นครสวรรค์ - กรุงเทพ (หัวลำโพง)", answer: "208" },
            { question: "กรุงเทพ (หัวลำโพง) - บ้านตาคลี", answer: "209" },
            { question: "บ้านตาคลี - กรุงเทพ (หัวลำโพง)", answer: "210" },
            { question: "กรุงเทพ (หัวลำโพง) - ตะพานหิน", answer: "211" },
            { question: "ตะพานหิน - กรุงเทพ (หัวลำโพง)", answer: "212" },
            { question: "กรุงเทพ (หัวลำโพง) - ลพบุรี", answer: "301" },
            { question: "ลพบุรี - กรุงเทพ (หัวลำโพง)", answer: "302" },
            { question: "กรุงเทพ (หัวลำโพง) - ลพบุรี", answer: "303" },
            { question: "ลพบุรี - กรุงเทพ (หัวลำโพง)", answer: "304" },
            { question: "กรุงเทพ (หัวลำโพง) - ชุมทางบ้านภาชี", answer: "313" },
            { question: "ชุมทางบ้านภาชี - กรุงเทพ (หัวลำโพง)", answer: "314" },
            { question: "กรุงเทพ (หัวลำโพง) - ลพบุรี", answer: "317" },
            { question: "ลพบุรี - กรุงเทพ (หัวลำโพง)", answer: "318" },
            { question: "ลพบุรี - พิษณุโลก", answer: "401" },
            { question: "พิษณุโลก - ลพบุรี", answer: "402" },
            { question: "พิษณุโลก - ศิลาอาสน์", answer: "403" },
            { question: "นครสวรรค์ - เชียงใหม่", answer: "407" },
            { question: "เชียงใหม่ - นครสวรรค์", answer: "408" },
            { question: "ศิลาอาสน์ - พิษณุโลก", answer: "410" },
            { question: "กรุงเทพอภิวัฒน์ - อุบลราชธานี", answer: "21" },
            { question: "อุบลราชธานี - กรุงเทพอภิวัฒน์", answer: "22" },
            { question: "กรุงเทพอภิวัฒน์ - อุบลราชธานี", answer: "23 CNR" },
            { question: "อุบลราชธานี - กรุงเทพอภิวัฒน์", answer: "24 CNR" },
            { question: "กรุงเทพอภิวัฒน์ - หนองคาย", answer: "25 CNR" },
            { question: "หนองคาย - กรุงเทพอภิวัฒน์", answer: "26 CNR" },
            { question: "กรุงเทพอภิวัฒน์ - อุบลราชธานี", answer: "71" },
            { question: "อุบลราชธานี - กรุงเทพอภิวัฒน์", answer: "72" },
            { question: "กรุงเทพอภิวัฒน์ - หนองคาย", answer: "75" },
            { question: "หนองคาย - กรุงเทพอภิวัฒน์", answer: "76" },
            { question: "กรุงเทพอภิวัฒน์ - เวียงจันทน์ (คำสะหวาด)", answer: "133" },
            { question: "เวียงจันทน์ (คำสะหวาด) - กรุงเทพอภิวัฒน์", answer: "134" },
            { question: "กรุงเทพอภิวัฒน์ - อุบลราชธานี", answer: "135" },
            { question: "อุบลราชธานี - กรุงเทพอภิวัฒน์", answer: "136" },
            { question: "กรุงเทพอภิวัฒน์ - อุบลราชธานี", answer: "139" },
            { question: "อุบลราชธานี - กรุงเทพอภิวัฒน์", answer: "140" },
            { question: "กรุงเทพอภิวัฒน์ - อุบลราชธานี", answer: "141" },
            { question: "อุบลราชธานี - กรุงเทพอภิวัฒน์", answer: "142" },
            { question: "หนองคาย - เวียงจันทน์ (คำสะหวาด)", answer: "147" },
            { question: "เวียงจันทน์ (คำสะหวาด) - หนองคาย", answer: "148" },
            { question: "กรุงเทพ (หัวลำโพง) - สุรินทร์", answer: "233" },
            { question: "สุรินทร์ - กรุงเทพ (หัวลำโพง)", answer: "234" },
            { question: "กรุงเทพ (หัวลำโพง) - ชุมทางแก่งคอย", answer: "339" },
            { question: "ชุมทางแก่งคอย - กรุงเทพ (หัวลำโพง)", answer: "340" },
            { question: "กรุงเทพ (หัวลำโพง) - ชุมทางแก่งคอย", answer: "341" },
            { question: "ชุมทางแก่งคอย - กรุงเทพ (หัวลำโพง)", answer: "342" },
            { question: "นครราชสีมา - หนองคาย", answer: "415" },
            { question: "อุดรธานี - นครราชสีมา", answer: "416" },
            { question: "นครราชสีมา - อุดรธานี", answer: "417" },
            { question: "หนองคาย - นครราชสีมา", answer: "418" },
            { question: "นครราชสีมา - อุบลราชธานี", answer: "419" },
            { question: "อุบลราชธานี - ลำชี", answer: "420" },
            { question: "นครราชสีมา - อุบลราชธานี", answer: "421" },
            { question: "อุบลราชธานี - ลำชี", answer: "422" },
            { question: "ลำชี - สำโรงทาบ", answer: "423" },
            { question: "สำโรงทาบ - นครราชสีมา", answer: "424" },
            { question: "ลำชี - อุบลราชธานี", answer: "425" },
            { question: "อุบลราชธานี - นครราชสีมา", answer: "426" },
            { question: "นครราชสีมา - อุบลราชธานี", answer: "427" },
            { question: "อุบลราชธานี - นครราชสีมา", answer: "428" },
            { question: "นครราชสีมา - ชุมทางบัวใหญ่", answer: "429" },
            { question: "ชุมทางบัวใหญ่ - นครราชสีมา", answer: "430" },
            { question: "ชุมทางแก่งคอย - ขอนแก่น", answer: "431" },
            { question: "ขอนแก่น - ชุมทางแก่งคอย", answer: "432" },
            { question: "ชุมทางแก่งคอย - ชุมทางบัวใหญ่", answer: "433" },
            { question: "ชุมทางบัวใหญ่ - ชุมทางแก่งคอย", answer: "434" },
            { question: "ชุมทางแก่งคอย - ชุมทางบัวใหญ่", answer: "439" },
            { question: "ชุมทางบัวใหญ่ - ชุมทางแก่งคอย", answer: "440" },
            { question: "กรุงเทพ (หัวลำโพง) - ด่านพรมแดนบ้านคลองลึก", answer: "275" },
            { question: "ด่านพรมแดนบ้านคลองลึก - กรุงเทพ (หัวลำโพง)", answer: "276" },
            { question: "กรุงเทพ (หัวลำโพง) - กบินทร์บุรี", answer: "277" },
            { question: "กบินทร์บุรี - กรุงเทพ (หัวลำโพง)", answer: "278" },
            { question: "กรุงเทพ (หัวลำโพง) - ด่านพรมแดนบ้านคลองลึก", answer: "279" },
            { question: "ด่านพรมแดนบ้านคลองลึก - กรุงเทพ (หัวลำโพง)", answer: "280" },
            { question: "กรุงเทพ (หัวลำโพง) - กบินทร์บุรี", answer: "281" },
            { question: "กบินทร์บุรี - กรุงเทพ (หัวลำโพง)", answer: "282" },
            { question: "กรุงเทพ (หัวลำโพง) - จุกเสม็ด", answer: "283" },
            { question: "จุกเสม็ด - กรุงเทพ (หัวลำโพง)", answer: "284" },
            { question: "กรุงเทพ (หัวลำโพง) - ชุมทางฉะเชิงเทรา", answer: "367" },
            { question: "ชุมทางฉะเชิงเทรา - กรุงเทพ (หัวลำโพง)", answer: "368" },
            { question: "กรุงเทพ (หัวลำโพง) - ปราจีนบุรี", answer: "371" },
            { question: "ปราจีนบุรี - กรุงเทพ (หัวลำโพง)", answer: "372" },
            { question: "กรุงเทพ (หัวลำโพง) - ชุมทางฉะเชิงเทรา", answer: "379" },
            { question: "ชุมทางฉะเชิงเทรา - กรุงเทพ (หัวลำโพง)", answer: "380" },
            { question: "กรุงเทพ (หัวลำโพง) - ชุมทางฉะเชิงเทรา", answer: "383" },
            { question: "ชุมทางฉะเชิงเทรา - กรุงเทพ (หัวลำโพง)", answer: "384" },
            { question: "ชุมทางฉะเชิงเทรา - กรุงเทพ (หัวลำโพง)", answer: "388" },
            { question: "กรุงเทพ (หัวลำโพง) - ชุมทางฉะเชิงเทรา", answer: "389" },
            { question: "ชุมทางฉะเชิงเทรา - กรุงเทพ (หัวลำโพง)", answer: "390" },
            { question: "กรุงเทพ (หัวลำโพง) - ชุมทางฉะเชิงเทรา", answer: "391" },
            { question: "มหาชัย - วงเวียนใหญ่", answer: "4302" },
            { question: "วงเวียนใหญ่ - มหาชัย", answer: "4303" },
            { question: "มหาชัย - วงเวียนใหญ่", answer: "4304" },
            { question: "วงเวียนใหญ่ - มหาชัย", answer: "4305" },
            { question: "มหาชัย - วงเวียนใหญ่", answer: "4306" },
            { question: "วงเวียนใหญ่ - มหาชัย", answer: "4307" },
            { question: "มหาชัย - วงเวียนใหญ่", answer: "4308" },
            { question: "วงเวียนใหญ่ - มหาชัย", answer: "4309" },
            { question: "มหาชัย - วงเวียนใหญ่", answer: "4310" },
            { question: "วงเวียนใหญ่ - มหาชัย", answer: "4311" },
            { question: "มหาชัย - วงเวียนใหญ่", answer: "4312" },
            { question: "วงเวียนใหญ่ - มหาชัย", answer: "4313" },
            { question: "มหาชัย - วงเวียนใหญ่", answer: "4314" },
            { question: "วงเวียนใหญ่ - มหาชัย", answer: "4315" },
            { question: "มหาชัย - วงเวียนใหญ่", answer: "4316" },
            { question: "วงเวียนใหญ่ - มหาชัย", answer: "4317" },
            { question: "มหาชัย - วงเวียนใหญ่", answer: "4320" },
            { question: "วงเวียนใหญ่ - มหาชัย", answer: "4321" },
            { question: "มหาชัย - วงเวียนใหญ่", answer: "4322" },
            { question: "วงเวียนใหญ่ - มหาชัย", answer: "4323" },
            { question: "มหาชัย - วงเวียนใหญ่", answer: "4324" },
            { question: "วงเวียนใหญ่ - มหาชัย", answer: "4325" },
            { question: "มหาชัย - วงเวียนใหญ่", answer: "4326" },
            { question: "วงเวียนใหญ่ - มหาชัย", answer: "4327" },
            { question: "มหาชัย - วงเวียนใหญ่", answer: "4328" },
            { question: "วงเวียนใหญ่ - มหาชัย", answer: "4329" },
            { question: "มหาชัย - วงเวียนใหญ่", answer: "4340" },
            { question: "วงเวียนใหญ่ - มหาชัย", answer: "4341" },
            { question: "มหาชัย - วงเวียนใหญ่", answer: "4342" },
            { question: "วงเวียนใหญ่ - มหาชัย", answer: "4343" },
            { question: "มหาชัย - วงเวียนใหญ่", answer: "4344" },
            { question: "วงเวียนใหญ่ - มหาชัย", answer: "4345" },
            { question: "มหาชัย - วงเวียนใหญ่", answer: "4346" },
            { question: "วงเวียนใหญ่ - มหาชัย", answer: "4347" },
            { question: "แม่กลอง - บ้านแหลม", answer: "4380" },
            { question: "บ้านแหลม - แม่กลอง", answer: "4381" },
            { question: "แม่กลอง - บ้านแหลม", answer: "4382" },
            { question: "บ้านแหลม - แม่กลอง", answer: "4383" },
            { question: "แม่กลอง - บ้านแหลม", answer: "4384" },
            { question: "บ้านแหลม - แม่กลอง", answer: "4385" },
            { question: "แม่กลอง - บ้านแหลม", answer: "4386" },
            { question: "บ้านแหลม - แม่กลอง", answer: "4387" }
        ];

        // --- ตรรกะของเกม ---
        const allTrainNumbers = trainData.map(item => item.answer);
        let shuffledQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let answered = false; // (ใหม่) ใช้เพื่อระบุว่าข้อปัจจุบันถูก "ส่งคำตอบ" แล้วหรือยัง
        let selectedAnswer = null; // (ใหม่) เก็บคำตอบที่ผู้ใช้เลือก
        let selectedButtonEl = null; // (ใหม่) เก็บปุ่มที่ผู้ใช้เลือก
        let allQuestionsAnswered = false; // (ใหม่) ใช้ตรวจสอบสถานะจบเกม

        // ดึง Element ต่างๆ จาก HTML
        const questionEl = document.getElementById('question');
        const optionsContainer = document.getElementById('options-container');
        const feedbackEl = document.getElementById('feedback');
        const scoreCounterEl = document.getElementById('score-counter');
        const submitButton = document.getElementById('submit-button'); // (ใหม่)
        const navButton = document.getElementById('navigation-button'); // (แก้ไข)

        // Function สับเปลี่ยนอาร์เรย์ (Fisher-Yates Shuffle)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // (ใหม่) Function อัปเดตตัวนับคะแนนและข้อที่เหลือ
        function updateCounters() {
            const remaining = shuffledQuestions.filter(q => q.status === 'unanswered').length;
            scoreCounterEl.textContent = `ข้อที่: ${currentQuestionIndex + 1}/${shuffledQuestions.length} | คะแนน: ${score} | เหลือ: ${remaining}`;
            return remaining;
        }
        
        // (ใหม่) Function สำหรับเลือกคำตอบ (ยังไม่ส่ง)
        function selectOption(button, option) {
            if (answered) return; // ถ้าส่งคำตอบแล้ว ห้ามเลือกใหม่

            // ล้างการเลือก قبอนหน้า
            const allOptions = optionsContainer.querySelectorAll('.option-button');
            allOptions.forEach(btn => btn.classList.remove('selected'));

            // ไฮไลท์อันที่เลือก
            button.classList.add('selected');
            selectedAnswer = option;
            selectedButtonEl = button;
            
            submitButton.style.display = 'inline-block'; // แสดงปุ่มส่งคำตอบ
        }

        // Function สร้างตัวเลือก 3 ข้อ (1 ถูก, 2 ผิด)
        function generateOptions(correctAnswer) {
            let options = [correctAnswer];
            while (options.length < 3) {
                const distractor = allTrainNumbers[Math.floor(Math.random() * allTrainNumbers.length)];
                if (!options.includes(distractor)) {
                    options.push(distractor);
                }
            }
            shuffleArray(options); // สลับลำดับตัวเลือก
            return options;
        }

        // Function แสดงคำถามและตัวเลือก
        function displayQuestion() {
            answered = false; // รีเซ็ตสถานะการตอบ
            selectedAnswer = null;
            selectedButtonEl = null;
            allQuestionsAnswered = false;

            const currentQuestion = shuffledQuestions[currentQuestionIndex];
            
            questionEl.textContent = currentQuestion.question;
            optionsContainer.innerHTML = ''; // ล้างตัวเลือกเก่า
            feedbackEl.textContent = ''; // ล้างข้อความ feedback
            
            submitButton.style.display = 'none'; // ซ่อนปุ่ม 'ส่งคำตอบ'
            navButton.style.display = 'inline-block'; // แสดงปุ่ม 'ข้าม'
            navButton.textContent = 'ข้าม';
            
            updateCounters(); // อัปเดตตัวนับ

            // สร้างตัวเลือก
            const options = generateOptions(currentQuestion.answer);

            options.forEach(option => {
                const button = document.createElement('button');
                button.textContent = option;
                button.classList.add('option-button');
                // (แก้ไข) เปลี่ยน event listener เป็น selectOption
                button.addEventListener('click', () => selectOption(button, option));
                optionsContainer.appendChild(button);
            });
        }
        
        // (ใหม่) Function ห่อหุ้ม checkAnswer เพื่อใช้กับ event listener
        function checkAnswerWrapper() {
            if (selectedAnswer === null) return; // ยังไม่ได้เลือก
            const correctAnswer = shuffledQuestions[currentQuestionIndex].answer;
            checkAnswer(selectedButtonEl, selectedAnswer, correctAnswer);
        }

        // (แก้ไข) Function ตรวจคำตอบ (เมื่อกดยืนยัน)
        function checkAnswer(selectedButton, selectedAnswer, correctAnswer) {
            if (answered) return; // ป้องกันการส่งซ้ำ
            answered = true;

            submitButton.style.display = 'none'; // ซ่อนปุ่มส่ง
            navButton.textContent = 'ข้อถัดไป'; // เปลี่ยนปุ่ม 'ข้าม' เป็น 'ข้อถัดไป'

            const buttons = optionsContainer.querySelectorAll('.option-button');
            
            // ปิดการใช้งานปุ่มทั้งหมดและแสดงเฉลย
            buttons.forEach(button => {
                button.disabled = true;
                if (button.textContent === correctAnswer) {
                    button.classList.add('correct');
                } else if (button === selectedButton) {
                    button.classList.add('incorrect');
                }
            });

            // แสดงผลลัพธ์และอัปเดตสถานะ
            if (selectedAnswer === correctAnswer) {
                feedbackEl.textContent = 'ถูกต้อง!';
                feedbackEl.style.color = '#28a745';
                // เพิ่มคะแนนเฉพาะเมื่อตอบถูกครั้งแรก
                if (shuffledQuestions[currentQuestionIndex].status === 'unanswered') {
                    score++;
                }
                shuffledQuestions[currentQuestionIndex].status = 'correct';
            } else {
                feedbackEl.textContent = `ผิด! คำตอบคือ ${correctAnswer}`;
                feedbackEl.style.color = '#dc3545';
                shuffledQuestions[currentQuestionIndex].status = 'incorrect';
            }
            
            updateCounters(); // อัปเดตคะแนน/ข้อที่เหลือ
        }
        
        // (ใหม่) Function แสดงคะแนนสุดท้าย
        function showFinalScore() {
            allQuestionsAnswered = true;
            questionEl.textContent = 'จบเกม!';
            optionsContainer.innerHTML = '';
            feedbackEl.textContent = `คุณทำได้ ${score} / ${shuffledQuestions.length} คะแนน`;
            feedbackEl.style.color = '#333';
            scoreCounterEl.textContent = 'ยอดเยี่ยม!';
            
            submitButton.style.display = 'none';
            navButton.textContent = 'เล่นอีกครั้ง';
            navButton.style.display = 'inline-block';
        }

        // (ใหม่) Function สำหรับปุ่ม ข้าม / ข้อถัดไป / เล่นอีกครั้ง
        function navigate() {
            if (allQuestionsAnswered) {
                startGame(); // ถ้าจบเกมแล้ว ให้เริ่มใหม่
                return;
            }

            // ค้นหาข้อถัดไปที่ยังไม่ได้ตอบ
            let nextIndex = -1;
            
            // 1. ค้นหาจากข้อปัจจุบัน + 1 ไปจนจบ
            for (let i = currentQuestionIndex + 1; i < shuffledQuestions.length; i++) {
                if (shuffledQuestions[i].status === 'unanswered') {
                    nextIndex = i;
                    break;
                }
            }

            // 2. ถ้าไม่เจอ ให้วนกลับมาค้นหาตั้งแต่ข้อ 0
            if (nextIndex === -1) {
                for (let i = 0; i < currentQuestionIndex; i++) {
                    if (shuffledQuestions[i].status === 'unanswered') {
                        nextIndex = i;
                        break;
                    }
                }
            }
            
            // 3. จัดการผลลัพธ์
            if (nextIndex !== -1) {
                // เจอข้อที่ยังไม่ตอบ
                currentQuestionIndex = nextIndex;
                displayQuestion();
            } else {
                // ไม่เจอข้อที่ยังไม่ตอบ (หมายความว่าตอบครบหมดแล้ว)
                // ตรวจสอบว่าข้อปัจจุบันตอบหรือยัง (กรณีที่ข้อสุดท้ายเป็นข้อเดียวที่เหลือ)
                if (shuffledQuestions[currentQuestionIndex].status === 'unanswered') {
                    // นี่คือข้อสุดท้ายที่ยังไม่ตอบ ไม่ต้องทำอะไร รอผู้ใช้ส่งคำตอบ
                    // (ปุ่ม 'ข้าม' จะไม่ควรพากลับมาที่นี่ แต่เผื่อไว้)
                } else {
                    // ตอบครบทุกข้อแล้ว
                    showFinalScore();
                }
            }
        }
        
        // Function เริ่มเกม
        function startGame() {
            score = 0;
            currentQuestionIndex = 0;
            allQuestionsAnswered = false;
            
            shuffledQuestions = [...trainData]; // คัดลอกข้อมูลมาใช้
            shuffleArray(shuffledQuestions); // สับเปลี่ยนคำถาม
            
            // (ใหม่) รีเซ็ตสถานะทั้งหมด
            shuffledQuestions.forEach(q => q.status = 'unanswered');

            // (ใหม่) ตั้งค่า listener ให้ปุ่มหลัก
            submitButton.onclick = checkAnswerWrapper;
            navButton.onclick = navigate;
            
            displayQuestion();
        }

        // เริ่มเกมครั้งแรกเมื่อหน้าเว็บโหลด
        document.addEventListener('DOMContentLoaded', startGame);
    </script>
</body>
</html>